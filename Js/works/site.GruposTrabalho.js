$(function () {     ListaGruposTrabalho(0); });   $("#pesquisa_workstation").click(function() {      if ( $('#workstation_tipopesq').val() ==  "" ){         $("#alert-warning").css({ display: "block" });         $("#alert-warning").fadeTo(2000, 500).slideUp(500, function(){             $("#alert-warning").slideUp(500);         });         return;     }     ListaGruposTrabalho(0);  });  $("#minha-work").click(function() {     ListaGruposTrabalho(1);  });   $("#limpar_pesquisa_workstation").click(function() {     LimparPesquisaGruposTrabalho();  });   $("#carregarMaisGrupos").click(function() {     CarregarMaisListaGruposTrabalho();  });  $("#criar-nova-work").click(function(){     $("#modal-nova-work").modal(); });    function ListaGruposTrabalho(filtroMinhaWork) {     var selecionado =  $("#workstation_tipopesq").val();        var grupoTrabalho = {         Titulo: selecionado == 1 ? $('#texto_pesquisa_workstation').val() : "",         Descricao: selecionado == 2 ? $('#texto_pesquisa_workstation').val() : "",         IdUltimaWorkstation: 0,         FiltrarMinhaWok: filtroMinhaWork     };       var dados =  JSON.stringify({ gruposTrabalho: grupoTrabalho });          $.ajax({         type: "POST",         url: '/GruposTrabalho/ListaGruposTrabalho',         contentType: "application/json; charset=utf-8",         data: dados,         dataType: "HTML",         success: function(recData) {              $('#listaGruposTrabalho').empty();             $('#listaGruposTrabalho').append(recData);         },         error: function() { alert('Ops, algo errado.'); }     }); }   function CarregarMaisListaGruposTrabalho() {     var selecionado =  $("#workstation_tipopesq").val();        var grupoTrabalho = {         Titulo: selecionado == 1 ? $('#texto_pesquisa_workstation').val() : "",         Descricao: selecionado == 2 ? $('#texto_pesquisa_workstation').val() : "",         IdUltimaWorkstation: $('.grid-item').last().attr('id')     };       var dados =  JSON.stringify({ gruposTrabalho: grupoTrabalho });          $.ajax({         type: "POST",         url: '/GruposTrabalho/CarregarMaisListaGruposTrabalho',         contentType: "application/json; charset=utf-8",         data: dados,         dataType: "HTML",         success: function(recData) {                  var $elems = $(recData);                          $('.grid').append( $elems ).masonry( 'appended', $elems );          },         error: function() { alert('Ops, algo errado.'); }     }); }   function SalvarGrupoTrabalho() {      var grupoTrabalho = {         Titulo: $('#titulo').val(),         Descricao: $('#novoGrupo').val()     };       var dados =  JSON.stringify({ gruposTrabalho: grupoTrabalho });          $.ajax({         type: "POST",         dataType: "JSON",         url: '/GruposTrabalho/SalvarGrupoTrabalho',         contentType: "application/json; charset=utf-8",         data: dados,         success: function(response) {              if (response.success) {                  UploadAvatar(response.novoId);              } else {                alert(response.mensagem);            }          },         error: function() { alert('Ops, algo errado.'); }     });  }   function UploadAvatar(novoId) {       var data = new FormData();     var files = $("#profilePic").get(0).files;     data.append("Image", files[0]);      data.append("novoIdGrupo", novoId);           $.ajax({         type: "POST",         dataType: "JSON",         url: '/GruposTrabalho/UploadAvatarGrupoTrabalho',         data: data,         contentType: false, // Not to set any content header           processData: false, // Not to process data           success: function(response) {              if (response.success) {                   //Limpar Campos                 $('#novoGrupo').froalaEditor('html.set', '');                 $('#titulo').val("");                 $('#descricao').val("");                 $('.imagePreview').css('background-image', 'url(' + '/Images/avatar-background.png' + ')');                 $('#participantes').val(null).change();                 $('#listaGruposTrabalho').empty();                 ListaGruposTrabalho(0);                  //mostra a mensagem de sucesso                     $("#modal-nova-work").modal('toggle');                  $("#success-alert").css({ display: "block" });                 $("#success-alert").fadeTo(2000, 500).slideUp(500, function(){                     $("#success-alert").slideUp(500);                 });                                } else {                alert(response.mensagem);            }          },         error: function() { alert('Ops, algo errado.'); }     });  }
   function LimparPesquisaGruposTrabalho(){     $('#texto_pesquisa_workstation').val("");     $('#workstation_tipopesq').val("");     ListaGruposTrabalho(0); }   $('#novoGrupo').froalaEditor({     language: 'pt_br',     codeMirror: false,     imageUploadURL: '/Editor/UploadFiles',      imageUploadParams: {       id: 'my_editor'     },     // Set custom buttons with separator between them.     toolbarButtons: ['undo', 'redo' , '|', 'insertLink', 'insertImage', 'insertVideo', 'emoticons'],     toolbarButtonsXS: ['undo', 'redo' , '|', 'insertLink', 'insertImage', 'insertVideo', 'emoticons'],     quickInsertButtons: ['image', 'video'],     charCounterMax: 5000 })   // Catch image remove $('#novoGrupo').on('froalaEditor.image.removed', function (e, editor, $img) {     $.ajax({         // Request method.         method: "POST",          // Request URL.         url: "/Editor/DeleteImage",          // Request params.         data: {             src: $img.attr('src')         }     })     .done (function (data) {         console.log ('image was deleted');     })     .fail (function () {         console.log ('image delete problem');     }) })    $(document).on("change",".uploadFile", function() {     var uploadFile = $(this);     var files = !!this.files ? this.files : [];      if (files[0].size > 1000000){ //TAMANHO MAXIMO DA IMAGEM          $("#alert-imagem").css({ display: "block" });         $("#alert-imagem").fadeTo(2000, 500).slideUp(500, function(){             $("#alert-imagem").slideUp(500);         });     }       if (!files.length || !window.FileReader || files[0].size > 1000000) return; // no file selected, or no FileReader support      if (/^image/.test( files[0].type)){ // Somente arquivo de imagem         var reader = new FileReader(); // instance of the FileReader         reader.readAsDataURL(files[0]); // read the local file         reader.onloadend = function(){ // set image data as background of div             uploadFile.closest(".imgUp").find('.imagePreview').css("background-image", "url("+this.result+")");         }     }  });   $('.char-count').keyup(function() {     var maxLength = parseInt($(this).attr('maxlength'));     var length = $(this).val().length;     var newLength = maxLength-length;     var name = $(this).attr('name');     $('span[name="'+name+'"]').text(newLength); });     